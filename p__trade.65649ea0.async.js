(self["webpackChunk_1kx_sourceCode"]=self["webpackChunk_1kx_sourceCode"]||[]).push([[974],{67297:function(e){e.exports={modal:"modal___1_gXd",result_title:"result_title___5hb-i",token:"token___1FK7M",name:"name___1bUZZ",result_link:"result_link___l4B_7"}},22278:function(e){e.exports={container:"container___2jKSa",editText:"editText___3GXKN",longText:"longText___15Duk",shortText:"shortText___2jJ9l",table_wrap:"table_wrap___3D8pK",tableTh:"tableTh___2bvcp"}},53768:function(e){e.exports={wrap:"wrap___1OpI5",item:"item___zU5Kt",title:"title___3culT",desc:"desc___3n3h3",long:"long___1uSq0",short:"short___3wkPh"}},16269:function(e){e.exports={container:"container___3YDFE",head:"head___15mBz",token:"token___29QUj",loading:"loading___3qch5"}},58162:function(e){e.exports={card:"card___1UP7m",label:"label___E0Z4P",value:"value___IacHa",amount:"amount___1Ncvm",info:"info___2gBow",item:"item___Vzey6",arr:"arr___3rZxA",green:"green___sEuxo",red:"red___NU2Lf",result_icon:"result_icon___BQsqf"}},21597:function(){},25631:function(e){e.exports={container:"container___1CbrE",datas:"datas___3_cio",table_datas:"table_datas___2RqPN",title_wrap:"title_wrap___22dT8",title:"title___112th",current_title:"current_title___3zuwG"}},60155:function(e){e.exports={card:"card___1iTMp",label:"label___1aijI",value:"value___7xM9H",amount:"amount___1evn4",info:"info___x8-9s",item:"item___asDq0",arr:"arr___2wrBs",green:"green___vlGjE",red:"red___3tRta",result_icon:"result_icon___1elrl"}},9696:function(e){e.exports={info:"info___1DWvF",item:"item___3hTZ9",value:"value___2vWj2"}},42226:function(e){e.exports={container:"container___JUd0k",menu:"menu___do0Dr"}},8372:function(e){e.exports={card:"card___-cdFP",label:"label___3sEo9",value:"value___27Ayq",amount:"amount___1R05F",info:"info___1wQzP",item:"item___2dUcO",arr:"arr___2_7li",green:"green___qdu2p",red:"red___1OEwC",result_icon:"result_icon___3-1TI",container:"container___2dK5f",green_btn:"green_btn___3-Dfq",red_btn:"red_btn___3H6fG",tradeTypes:"tradeTypes___3EkL1",active:"active___2HsGX",modalWrap:"modalWrap___23PE4",modal:"modal___3xaEM",modalContainer:"modalContainer___3rtr6",title:"title___4HGu5",subTitle:"subTitle___2lVqs",icon:"icon___peR4F",content:"content___3cJhK",DescriptionItem:"DescriptionItem___3nOyb"}},1055:function(e){e.exports={action:"action___1mXKf",close:"close___1JRKn",green:"green___5xcuC",red:"red___3IMlB",table:"table___10SoB",type:"type___19l_i",text:"text___6Jsaq"}},43591:function(e){e.exports={card:"card___12_YK",label:"label___1i87X",value:"value___10mvD",amount:"amount___1a1tA",info:"info___1E0ri",item:"item___2rFou",arr:"arr___1G7cO",green:"green___1DTBX",red:"red___3bNDu",result_icon:"result_icon___3TEtn",container:"container___1akww",cardPay:"cardPay___3iFvS",cardReceive:"cardReceive___21mqq",title:"title___1UCoc",arrCircle:"arrCircle___1UUf_"}},49469:function(e){e.exports={card:"card___23Xeh",label:"label___1yf02",value:"value___1izNl",amount:"amount___1TgUu",info:"info___2ZjGy",item:"item___lQXSz",arr:"arr___37VJx",green:"green___2xKdg",red:"red___3B8Id",result_icon:"result_icon___1le6K",slider:"slider___1EgIv",row:"row___1sQqU",tpsl:"tpsl___31WMX",checkbox:"checkbox___2CZwt",silder_trigger:"silder_trigger___3-UZq",txt:"txt____r4mf",dig:"dig___1vySU",amount_green:"amount_green___1LFDz",amount_red:"amount_red___1if3C"}},50710:function(e){e.exports={container:"container___3aGt9"}},80638:function(){},38973:function(e,t,n){"use strict";n.d(t,{x:function(){return h}});n(71194);var a=n(37079),r=n(67297),s=n.n(r),i=n(86914),l=n(49878),c=n(88249),o=n.n(c),d=n(3150),u=n(19159),m=n(89072),x=n(48521);function h(e){var t=e.msg,n=e.txid,r=e.token,c=e.onOk,h=e.chainId,_=r||{},p=_.icon,v=_.tokenId,g=_.symbol,f=(0,m.x)(h);a.Z.warning({width:420,title:"",content:(0,x.jsxs)("div",{className:s().container,children:[(0,x.jsxs)("div",{className:s().result_title,children:[r&&(0,x.jsxs)("div",{className:s().token,children:[p?(0,x.jsx)("img",{src:p,width:25}):(0,x.jsx)(u.Z,{tokenId:v,size:25}),(0,x.jsx)("div",{className:s().name,children:g})]}),t]}),(0,x.jsxs)("div",{className:s().result_link,children:[(0,x.jsxs)("a",{className:"primary",href:"".concat(f.exporerTxUrl,"/").concat(n,"?network=").concat(f.network),target:"_blank",rel:"noreferrer",children:[(0,i.Z)("browse"),": ",(0,d.Zp)(n,[16,16])]}),(0,x.jsx)(l.Z,{text:n,children:(0,x.jsx)("img",{src:o(),style:{cursor:"pointer"}})})]})]}),onOk:c,okText:(0,i.Z)("ok"),wrapClassName:s().modal,getContainer:()=>document.getElementById("J_Page")||document.body})}},66993:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return $t}});var a=n(8870),r=n(2824),s=n(3786),i=n(67294),l=n(55902),c=n(16269),o=n.n(c),d=n(3150),u=n(48521),m=(0,d.l$)(),x="iPhone"===m||"Android"===m;function h(e){window.tvWidget.selectedIntervalButton&&window.tvWidget.selectedIntervalButton.classList.remove("selected"),e.classList.add("selected"),window.tvWidget.selectedIntervalButton=e}function _(e){var t=e.symbol,n=e.theme,a=(0,l.Kd)(),r=()=>{var e="https://zksync-data-feed.onchain.trade/data-feed",r="30",s=new window.Datafeeds.UDFCompatibleDatafeed(e),i={bg:"#1D2233",text:"#fff"},l={bg:"#fff",text:"#000"},c="Dark"===n?i:l;window.tvWidget=new window.TradingView.widget({symbol:t.toLowerCase(),interval:r,container:"tv_chart_container",width:x?"360px":"676px",height:"302px",datafeed:s,library_path:"/charting_library/",locale:"zh-cn"===a?"zh":"en",disabled_features:["use_localstorage_for_settings","header_widget_dom_node","header_symbol_search","header_resolutions","header_chart_type","header_settings","header_indicators","header_compare","header_undo_redo","header_screenshot","header_fullscreen_button","border_around_the_chart","header_saveload","drawing_templates","source_selection_markers","volume_force_overlay","create_volume_indicator_by_default_once","create_volume_indicator_by_default","study_symbol_ticker_description","insert_indicator_dialog_shortcut"],enabled_features:["header_widget"],charts_storage_url:"https://saveload.tradingview.com",charts_storage_api_version:"1.1",client_id:"tradingview.com",user_id:"public_user_id",preset:"mobile",toolbar_bg:"#ffffff",header_widget_buttons_mode:"adaptive",loading_screen:{backgroundColor:c.bg,foregroundColor:"#03cdc1"},theme:n,overrides:{"paneProperties.backgroundType":"solid","paneProperties.background":c.bg,"paneProperties.backgroundGradientStartColor":"#ffffff","scalesProperties.lineColor":c.text,"scalesProperties.textColor":c.text,"paneProperties.vertGridProperties.color":c.bg,"paneProperties.horzGridProperties.color":c.bg,"mainSeriesProperties.candleStyle.barColorsOnPrevClose":!0,"mainSeriesProperties.haStyle.barColorsOnPrevClose":!0,"mainSeriesProperties.barStyle.barColorsOnPrevClose":!0}}),window.tvWidget.onChartReady((()=>{var e=window.tvWidget.chart(),t=window.tvWidget._iFrame.contentWindow.document.getElementsByTagName("html")[0];t.style.setProperty("--tv-color-pane-background",c.bg);var n=[{label:"time",resolution:"15s"},{label:"1m",resolution:"1"},{label:"5m",resolution:"5"},{label:"15m",resolution:"15"},{label:"30m",resolution:"30"},{label:"1h",resolution:"60"},{label:"4h",resolution:"240"},{label:"1d",resolution:"D"},{label:"1w",resolution:"1W"},{label:"1m",resolution:"1M"},{label:"1y",resolution:"12M"}];e.onIntervalChanged().subscribe(null,(function(){window.tvWidget.changingInterval=!1})),n.forEach((t=>{var n=window.tvWidget.createButton();t.resolution===r&&h(n),n.setAttribute("data-resolution",t.resolution),n.setAttribute("data-chart-type",1),n.innerHTML="<span>"+t.label+"</span>",n.addEventListener("click",(function(){var t=+n.getAttribute("data-chart-type"),a=n.getAttribute("data-resolution");localStorage.setItem("tv-interval-charttype","".concat(a,"-").concat(t)),window.tvWidget.changingInterval||n.classList.contains("selected")||(e.resolution()!==a&&(window.tvWidget.changingInterval=!0,s._hasExeGetBars=!1,e.setResolution(a)),e.chartType()!==t&&(e.setChartType(t),s._hasExeGetBars=!1),h(n))}))}))}))};return(0,i.useEffect)((()=>{r()}),[n,t]),(0,u.jsx)("div",{id:"tv_chart_container"})}var p=_,v=(n(71194),n(37079)),g=n(43856),f=n(28759),j=n.n(f),Z=n(86914),k=n(33925),b=n(55130),w=(n(47673),n(40305)),y=n(76570),N=e=>{var t=/([\(\[\{\\\^\$\}\]\)\?\*\+\.])/gim;return e&&t.test(e)?e.replace(t,"\\$1"):e},S=(e,t)=>{var n=new RegExp(".*?"+N(e)+".*?","img");return t.filter((t=>n.test(t.symbol)||e==t.tokenId||e==t.liquidity))};function T(e){var t=e.changeShowList,n=e.data,a=e=>{var a=e.target.value;if(!a)return t(n);var r=S(a,n);t(r)};return(0,u.jsx)(w.Z,{placeholder:(0,Z.Z)("search_tips"),onChange:a,className:"search_input",allowClear:!0,prefix:(0,u.jsx)(y.Z,{})})}var P=T,I=n(19159),C=n(6011);function D(e){var t=e.changeToken,n=e.data,a=void 0===n?[]:n,s=e.currentToken,l=e.isLogin,c=e.loading,o=e.className,d=(0,i.useState)(!1),m=(0,r.Z)(d,2),x=m[0],h=m[1],_=(0,i.useState)(a),p=(0,r.Z)(_,2),f=p[0],w=p[1],y=(0,i.useState)(void 0),N=(0,r.Z)(y,2),S=N[0],T=N[1],D=void 0;s&&s.tokenId&&(D=a.findIndex((e=>e.tokenId===s.tokenId))),(0,i.useEffect)((()=>{a.length>0&&w(a)}),[a,l]);var L=e=>{h(!1),t(e)};return(0,u.jsxs)(u.Fragment,{children:["undefined"===typeof D?(0,u.jsxs)("div",{className:"".concat(j().token," ").concat(j().noToken," ").concat(o),onClick:()=>h(!0),children:[(0,u.jsx)("div",{className:j().noData,children:(0,Z.Z)("select_asset")}),(0,u.jsx)(g.m6,{})]}):(0,u.jsx)(k.Z,{className:o,changeToken:()=>h(!0),data:s}),(0,u.jsx)(v.Z,{width:420,footer:null,open:x,getContainer:()=>document.getElementById("J_Page")||document.body,onCancel:()=>h(!1),closable:!1,wrapClassName:j().modal,children:(0,u.jsx)(C.g,{spinning:c,children:(0,u.jsxs)("div",{className:j().container,children:[(0,u.jsx)("div",{className:j().search_wrap,children:(0,u.jsx)(P,{changeShowList:e=>T(e),data:a})}),(0,u.jsx)("div",{className:j().content,children:(S||f).map(((e,t)=>{var n=e.symbol,a=e.fullName,r=e.icon,s=e.iconLp,i=e.tokenId,l=e.userTokenBalance,c=l;return(0,u.jsxs)("div",{className:D===t?"".concat(j().item," ").concat(j()["no".concat(t)]," ").concat(j().selected_item):"".concat(j().item," ").concat(j()["no".concat(t)]),onClick:()=>L(e),children:[(0,u.jsxs)("div",{className:j().info,children:[(0,u.jsx)("div",{className:j().icon,children:s||r?(0,u.jsx)("img",{src:r}):(0,u.jsx)(I.Z,{tokenId:i,size:25})}),(0,u.jsxs)("div",{className:j().title,children:[(0,u.jsx)("div",{className:j().symbol,children:n}),(0,u.jsx)("div",{className:j().full_name,children:a})]})]}),(0,u.jsxs)("div",{className:j().balance,children:[(0,u.jsx)("div",{className:j().no,children:c}),(0,u.jsx)("div",{className:j().usd,children:(0,u.jsx)(b.Z,{data:{amount:Number(c),token:e}})})]})]},i)}))})]})})})]})}var L=D,F=n(34795),M=n(53768),E=n.n(M);function B(e){var t=e.data,n=t.longFundingRate,a=t.shortFundingRate,r=t.totalShortSize,s=t.totalLongSize,i=t.userIndexPrice,l=t.userIndexTokenDecimal,c=e=>{if(!e)return 0;var t=(0,d.gB)(e.toString(),l);return(0,d.Ce)(t,i)};return l?(0,u.jsxs)("div",{className:E().wrap,children:[(0,u.jsxs)("div",{className:E().item,children:[(0,u.jsx)("div",{className:E().title,children:"Mark: "}),(0,u.jsx)("div",{className:E().desc,children:"Spot: "})]}),(0,u.jsxs)("div",{className:E().item,children:[(0,u.jsx)("div",{className:E().title,children:" "}),(0,u.jsx)("div",{className:E().desc,children:"24H Volume"})]}),(0,u.jsxs)("div",{className:E().item,children:[(0,u.jsx)("div",{className:E().title,children:" "}),(0,u.jsx)("div",{className:E().desc,children:"24H Fee "})]}),(0,u.jsxs)("div",{className:E().item,children:[(0,u.jsxs)("div",{className:E().long,children:["L $",c(s||0)," | ",(0,F.z)(n||0)]}),(0,u.jsxs)("div",{className:E().short,children:["S $",c(r||0)," | ",(0,F.z)(a||0)]})]}),(0,u.jsxs)("div",{className:E().item,children:[(0,u.jsx)("div",{className:E().title,children:" "}),(0,u.jsx)("div",{className:E().desc,children:"APY "})]})]}):null}var O=B;function $(e){var t=(0,l.I0)(),n=e.isDarkMode,a=e.tokenDatas,s=e.chartSelectedTokenId,c=e.isLogin,d=e.chartSelectedPair,m=e.loadError;console.log(d,"chartSelectedPair");var x=(0,i.useState)({}),h=(0,r.Z)(x,2),_=h[0],v=h[1],g=e=>{t({type:"tokens/save",payload:{chartSelectedTokenId:e.id,chartSelectedPair:{}}})};return(0,i.useEffect)((()=>{if(s){var e=a.find((e=>e.id===s));e&&v(e)}else a&&a[0]&&v(a[0])}),[s,a,a&&a.length]),(0,u.jsx)("div",{className:"panel ".concat(o().container),children:!a||_.symbol||m?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:o().head,children:[(0,u.jsx)(L,{currentToken:_,changeToken:g,data:(a||[]).filter((e=>e.symbol&&"osd"!==e.symbol.toLowerCase())),className:o().token,loading:a&&a.length<1,isLogin:c}),d&&(0,u.jsx)(O,{data:d})]}),_.symbol&&(0,u.jsx)(p,{theme:n?"Dark":"Light",symbol:_.symbol})]}):(0,u.jsx)("div",{className:o().loading,children:(0,u.jsx)(C.g,{})})})}var z=e=>{var t=e.common,n=e.tokens,r=e.wallet;return(0,a.Z)((0,a.Z)((0,a.Z)({},t),n),r)},R=(0,l.$j)(z)($),q=n(25631),W=n.n(q),A=n(89544),U=n(44512),H=n(39428),K=n(3182),G=n(43591),X=n.n(G),V=n(21512),J=n(2593);function Q(e,t){var n=Math.round(1e4*+t),a=J.O$.from(e).sub(J.O$.from(e).mul(n).div(1e6));return a.toString()}function Y(e,t){var n=Math.round(1e4*+t),a=J.O$.from(e).add(J.O$.from(e).mul(n).div(1e6));return a.toString()}var ee=n(19186),te=n(75899),ne=n(68052),ae=n(905);function re(e){var t=e.walletChainId,n=e.tokenDatas,s=e.currentWallet,c=e.osdTokenData,o=e.slippage,m=e.isLogin,x=e.swapTokenId,h=e.loadingData,_=e.loadError,p=(0,l.I0)(),v=(0,i.useState)(""),f=(0,r.Z)(v,2),j=f[0],k=f[1],b=(0,i.useState)(x),w=(0,r.Z)(b,2),y=w[0],N=w[1],S=(0,i.useState)(""),T=(0,r.Z)(S,2),P=T[0],I=T[1],D=(0,i.useState)(""),L=(0,r.Z)(D,2),F=L[0],M=L[1],E=(0,i.useState)(""),B=(0,r.Z)(E,2),O=B[0],$=B[1],z=(0,i.useState)("0"),R=(0,r.Z)(z,2),q=R[0],W=R[1],U=(0,i.useState)(""),G=(0,r.Z)(U,2),J=G[0],re=G[1],se=(0,i.useState)(0),ie=(0,r.Z)(se,2),le=ie[0],ce=ie[1],oe=(0,i.useState)(!1),de=(0,r.Z)(oe,2),ue=de[0],me=de[1],xe=(0,i.useState)(""),he=(0,r.Z)(xe,2),_e=he[0],pe=he[1],ve=(0,i.useState)(!1),ge=(0,r.Z)(ve,2),fe=ge[0],je=ge[1],Ze=(0,i.useState)(0),ke=(0,r.Z)(Ze,2),be=ke[0],we=(ke[1],(0,d._u)(j,n?[...n,c]:[])),ye=(0,d._u)(y,n?[...n,c]:[]),Ne=s||{},Se=Ne.getTokenPrice,Te=Ne.calcSwapAmountIn,Pe=Ne.swap,Ie=Ne.calcSwapAmountOut,Ce=Ne.calcPoolTotal;(0,i.useEffect)((()=>{function e(){return t.apply(this,arguments)}function t(){return t=(0,K.Z)((0,H.Z)().mark((function e(){var t;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("in"===O&&P?Re(P):"out"===O&&F&&Ue(F),s){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Ce(we,ye);case 5:t=e.sent,ce(t);case 7:case"end":return e.stop()}}),e)}))),t.apply(this,arguments)}y&&j&&e()}),[y,j,m]);var De=()=>{je(!1),I(""),M(""),re(""),W("0"),p({type:"tokens/updatePrice"})},Le=e=>{re(e),je(!0),p({type:"tokens/updatePrice"})},Fe=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){var n,a,r,i,l,c;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return clearTimeout(be),e.next=3,(0,d.bX)(s,t);case 3:if(n=e.sent,n){e.next=6;break}return e.abrupt("return");case 6:return console.log(s,"currentWallet"),me(!0),a=(0,d.xo)(P,we.tokenDecimal),r=(0,d.xo)(F,ye.tokenDecimal),i=Y(a,o),l=Q(r,o),e.next=14,Pe({chainId:t,tokenIn:j,amountInRaw:a,amountInRawMax:i,tokenOut:y,amountOutRaw:r,amountOutRawMin:l,type:O});case 14:c=e.sent,c.error?(0,ee.y)(c.error,{tokenOut:ye.symbol,tokenIn:we.symbol}):c.hash&&Le(c.hash),me(!1);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function Me(e,t){return Ee.apply(this,arguments)}function Ee(){return Ee=(0,K.Z)((0,H.Z)().mark((function e(n,a){var r,s,i,l;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n&&a){e.next=2;break}return e.abrupt("return","0");case 2:return e.next=4,Se(j,t,we.tokenDecimal,we);case 4:return r=e.sent,e.next=7,Se(y,t,ye.tokenDecimal,ye);case 7:if(s=e.sent,r&&s){e.next=10;break}return e.abrupt("return","0");case 10:return i=new ae.Z(n).multipliedBy(r).div(s),l=i.minus(a).div(i).multipliedBy(100).abs(),e.abrupt("return",i.eq(0)?0:(0,d.FH)(l.toString(),2));case 13:case"end":return e.stop()}}),e)}))),Ee.apply(this,arguments)}function Be(e){return Oe.apply(this,arguments)}function Oe(){return Oe=(0,K.Z)((0,H.Z)().mark((function e(n){var a,r,i=arguments;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:"0",$(n),"in"===n?I(a):M(a),e.next=5,(0,d.bX)(s,t);case 5:if(r=e.sent,r&&j&&y){e.next=8;break}return e.abrupt("return");case 8:(0,d.Ds)("in"===n?Re:Ue,500)(a);case 9:case"end":return e.stop()}}),e)}))),Oe.apply(this,arguments)}function $e(e,t){return ze.apply(this,arguments)}function ze(){return ze=(0,K.Z)((0,H.Z)().mark((function e(n,a){var r,s,i;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ie(t,a,j,y);case 2:if(r=e.sent,!r.error){e.next=9;break}(0,ee.y)(r.error,{tokenOut:ye.symbol,tokenIn:we.symbol}),M(""),W("0"),e.next=15;break;case 9:return s=(0,d.gB)(r.toString(),ye.tokenDecimal,0),M(s),e.next=13,Me(n,s);case 13:i=e.sent,W(i);case 15:case"end":return e.stop()}}),e)}))),ze.apply(this,arguments)}function Re(e){return qe.apply(this,arguments)}function qe(){return qe=(0,K.Z)((0,H.Z)().mark((function e(n){var a,r;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return clearTimeout(be),e.next=3,(0,d.bX)(s,t);case 3:if(a=e.sent,a){e.next=6;break}return e.abrupt("return");case 6:if(n){e.next=10;break}return M(""),W("0"),e.abrupt("return");case 10:return pe("in"),r=(0,d.xo)(n,we.tokenDecimal),e.next=14,$e(n,r);case 14:pe("");case 15:case"end":return e.stop()}}),e)}))),qe.apply(this,arguments)}function We(e,t){return Ae.apply(this,arguments)}function Ae(){return Ae=(0,K.Z)((0,H.Z)().mark((function e(n,a){var r,s,i;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Te(t,a,j,y);case 2:if(r=e.sent,!r.error){e.next=9;break}(0,ee.y)(r.error,{tokenOut:ye.symbol,tokenIn:we.symbol}),I(""),W("0"),e.next=15;break;case 9:return s=(0,d.gB)(r.toString(),we.tokenDecimal,0),I(s),e.next=13,Me(s,n);case 13:i=e.sent,W(i);case 15:case"end":return e.stop()}}),e)}))),Ae.apply(this,arguments)}function Ue(e){return He.apply(this,arguments)}function He(){return He=(0,K.Z)((0,H.Z)().mark((function e(t){var n;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(clearTimeout(be),t){e.next=5;break}return I(""),W("0"),e.abrupt("return");case 5:return pe("out"),n=(0,d.xo)(t,ye.tokenDecimal),e.next=9,We(t,n);case 9:pe("");case 10:case"end":return e.stop()}}),e)}))),He.apply(this,arguments)}var Ke=()=>{var e=j;clearTimeout(be),k(y),N(e)},Ge=parseFloat(q)>parseFloat(o);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(C.g,{spinning:n&&n.length<1&&!_||h||ue,children:(0,u.jsxs)("div",{className:X().container,children:[(0,u.jsx)(te.Z,{className:X().cardPay,title:(0,Z.Z)("pay"),amount:"out"===_e?A.m5:P,onAmountChange:e=>Be("in",(e||"0").toString()),token:we,onChangeToken:e=>{e.tokenId===y&&Ke(),k(e.tokenId)}}),(0,u.jsx)("div",{className:X().arr,onClick:Ke,children:(0,u.jsx)(g.re,{className:X().arrCircle})}),(0,u.jsx)(te.Z,{className:X().cardReceive,amount:"in"===_e?A.m5:F,onAmountChange:e=>Be("out",(e||"0").toString()),token:ye,title:(0,Z.Z)("receive"),onChangeToken:e=>{e.tokenId===j&&Ke(),N(e.tokenId),p({type:"tokens/save",payload:{chartSelectedTokenId:e.tokenId,chartSelectedPair:{}}})}}),(0,u.jsx)("div",{className:X().info,children:(0,u.jsxs)("div",{className:X().item,children:[(0,u.jsxs)("div",{className:X().label,children:[(0,Z.Z)("price_impact")," + ",(0,Z.Z)("fee")]}),(0,u.jsxs)("div",{className:Ge?"".concat(X().fee," ").concat(X().red):X().fee,children:[q,"%"]})]})}),(0,u.jsx)(V.Z,{height:50,align:"center",onClick:Fe,redCond:Ge,conditions:[{handle:!j||!y,txt:(0,Z.Z)("select_asset")},{handle:le>0&&parseFloat(F)>le,txt:(0,Z.Z)("not_enough",ye.symbol)},{handle:parseFloat(P||"0")<=0||parseFloat(F||"0")<=0,txt:(0,Z.Z)("input_amount")},{handle:parseFloat(P||"0")>parseFloat(we.userTokenBalance||"0"),txt:(0,Z.Z)("lack_balance")}],children:Ge?(0,Z.Z)("swap_anyway"):(0,Z.Z)("swap")})]})}),fe&&(0,u.jsx)(ne.Z,{title:(0,Z.Z)("swap_done"),amountTile:(0,Z.Z)("swap_amount"),txid:J,visible:fe,close:De,chainId:t,tokenIn:(0,a.Z)((0,a.Z)({},we),{},{amount:P}),tokenOuts:[(0,a.Z)((0,a.Z)({},ye),{},{amount:F})]})]})}var se=e=>{var t=e.common,n=e.tokens,r=e.wallet,s=e.loading,i=s.effects;return(0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},t),n),r),{},{loadingData:i["tokens/getData"]})},ie=(0,l.$j)(se)(re),le=(n(77883),n(49747)),ce=(n(34792),n(0)),oe=(n(38663),n(80638),n(96156)),de=n(22122),ue=n(90484),me=n(94184),xe=n.n(me),he=n(53124),_e=(0,i.createContext)({}),pe=_e,ve=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};function ge(e){return"number"===typeof e?"".concat(e," ").concat(e," auto"):/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?"0 0 ".concat(e):e}var fe=["xs","sm","md","lg","xl","xxl"],je=i.forwardRef((function(e,t){var n,a=i.useContext(he.E_),r=a.getPrefixCls,s=a.direction,l=i.useContext(pe),c=l.gutter,o=l.wrap,d=l.supportFlexGap,u=e.prefixCls,m=e.span,x=e.order,h=e.offset,_=e.push,p=e.pull,v=e.className,g=e.children,f=e.flex,j=e.style,Z=ve(e,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),k=r("col",u),b={};fe.forEach((function(t){var n,a={},r=e[t];"number"===typeof r?a.span=r:"object"===(0,ue.Z)(r)&&(a=r||{}),delete Z[t],b=(0,de.Z)((0,de.Z)({},b),(n={},(0,oe.Z)(n,"".concat(k,"-").concat(t,"-").concat(a.span),void 0!==a.span),(0,oe.Z)(n,"".concat(k,"-").concat(t,"-order-").concat(a.order),a.order||0===a.order),(0,oe.Z)(n,"".concat(k,"-").concat(t,"-offset-").concat(a.offset),a.offset||0===a.offset),(0,oe.Z)(n,"".concat(k,"-").concat(t,"-push-").concat(a.push),a.push||0===a.push),(0,oe.Z)(n,"".concat(k,"-").concat(t,"-pull-").concat(a.pull),a.pull||0===a.pull),(0,oe.Z)(n,"".concat(k,"-rtl"),"rtl"===s),n))}));var w=xe()(k,(n={},(0,oe.Z)(n,"".concat(k,"-").concat(m),void 0!==m),(0,oe.Z)(n,"".concat(k,"-order-").concat(x),x),(0,oe.Z)(n,"".concat(k,"-offset-").concat(h),h),(0,oe.Z)(n,"".concat(k,"-push-").concat(_),_),(0,oe.Z)(n,"".concat(k,"-pull-").concat(p),p),n),v,b),y={};if(c&&c[0]>0){var N=c[0]/2;y.paddingLeft=N,y.paddingRight=N}if(c&&c[1]>0&&!d){var S=c[1]/2;y.paddingTop=S,y.paddingBottom=S}return f&&(y.flex=ge(f),!1!==o||y.minWidth||(y.minWidth=0)),i.createElement("div",(0,de.Z)({},Z,{style:(0,de.Z)((0,de.Z)({},y),j),className:w,ref:t}),g)}));var Ze=je,ke=Ze,be=n(8372),we=n.n(be),ye=n(15873),Ne=(n(66126),n(99177)),Se=(n(77576),n(12028)),Te=(n(63185),n(9676)),Pe=n(49469),Ie=n.n(Pe);function Ce(e){var t=e.maxLeverage,n=e.leverage,a=e.setLeverage,s=e.setTPSL,l=e.tpsl,c=e.tpPrice,o=e.setTpPrice,d=e.slPrice,m=e.setSlPrice,x=e.targetPrice,h=e.isLong,_=e.amountOut,p=e.tradeType,v=(0,i.useState)(!1),g=(0,r.Z)(v,2),f=g[0],j=g[1],k=(0,i.useState)(n),b=(0,r.Z)(k,2),w=b[0],y=b[1],N=(0,i.useMemo)((()=>{var e=0,t=0;return 0!==_&&(e=h?(c-x)*_*n:(x-c)*_*n,t=h?(c-x)/x*100*n:(x-c)/x*100*n),{rate:Number(t.toFixed(2))+"%",priceRate:Number(((c-x)/x*100).toFixed(2))+"%",amount:Number(e.toFixed(2))}}),[c,x,n,_,h]),S=(0,i.useMemo)((()=>{var e=0,t=0;return 0!==_&&(e=h?(x-d)*_*n:(d-x)*_*n,t=h?(x-d)/x*100*n:(d-x)/x*100*n),{rate:Number(t.toFixed(2))+"%",priceRate:Number(((x-d)/x*100).toFixed(2))+"%",amount:Number(e.toFixed(2))}}),[d,x,n,_,h]),T=e=>{s(e.target.checked)},P=e=>{j(e)},I=e=>{console.log(e),y(e),a(e)};return(0,i.useEffect)((()=>{t<n&&I(t)}),[t]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:Ie().row,children:["limit"===p?(0,u.jsxs)("div",{className:Ie().tpsl,children:["TP/SL ",(0,u.jsx)(Te.Z,{onChange:T,checked:l,className:Ie().checkbox})]}):(0,u.jsx)("div",{className:Ie().tpsl}),(0,u.jsxs)("div",{className:Ie().silder_trigger,children:[(0,u.jsx)("div",{children:(0,u.jsx)(le.Z,{value:w,onChange:I,min:1,max:t||1,className:Ie().dig})}),(0,u.jsx)("span",{className:Ie().txt,children:(0,Z.Z)("slider")}),(0,u.jsx)(Se.Z,{onChange:P})]})]}),f&&(0,u.jsx)(Ne.Z,{value:w,onChange:I,className:Ie().slider,min:1,max:t||1}),"limit"===p&&l&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:Ie().card,children:[(0,u.jsxs)("div",{className:Ie().label,children:[(0,u.jsxs)("div",{children:[(0,Z.Z)("tp_price"),"(",N.priceRate," ",(0,Z.Z)("up"),")"]}),(0,u.jsx)("div",{children:(0,Z.Z)("estimated_profit")})]}),(0,u.jsxs)("div",{className:Ie().value,children:[(0,u.jsx)(le.Z,{className:"inputTxt",value:c,onChange:o,min:0,formatter:e=>"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}),(0,u.jsxs)("div",{className:Ie().amount_green,children:["$",N.amount,"(",N.rate,")"]})]})]}),(0,u.jsxs)("div",{className:Ie().card,children:[(0,u.jsxs)("div",{className:Ie().label,children:[(0,u.jsxs)("div",{children:[(0,Z.Z)("tigger_price"),"(",S.priceRate," ",(0,Z.Z)("down"),")"]}),(0,u.jsx)("div",{children:(0,Z.Z)("estimated_loss")})]}),(0,u.jsxs)("div",{className:Ie().value,children:[(0,u.jsx)(le.Z,{className:"inputTxt",value:d,onChange:m,min:0,formatter:e=>"\u2265 $ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")}),(0,u.jsxs)("div",{className:Ie().amount_red,children:["$",S.amount,"(",S.rate,")"]})]})]})]})]})}var De=Ce,Le=n(26347),Fe=n(38973),Me=n(39423),Ee=n(51159),Be=(e,t)=>{if(!e)return{};if(!t)return{};console.log(t);var n=t.find((t=>t.id&&t.id.toLowerCase()===e.toLowerCase()));return n||{}},Oe=e=>{var t=e.label,n=e.value;return(0,u.jsx)(ke,{span:24,children:(0,u.jsxs)("div",{className:we().DescriptionItem,children:[(0,u.jsxs)("p",{className:we().DescriptionItemLabel,children:[t,":"]}),(0,u.jsx)("p",{className:we().DescriptionItemValue,children:n||"--"})]})})};function $e(e){var t=(0,l.I0)(),n=e.isLogin,s=e.tokenDatas,c=e.osdTokenData,o=e.tokenPairs,m=e.isLong,x=e.currentWallet,h=e.walletChainId,_=e.positionList,p=(0,i.useState)(0),g=(0,r.Z)(p,2),f=g[0],j=g[1],k=(0,i.useState)(""),b=(0,r.Z)(k,2),w=b[0],y=b[1],N=(0,i.useState)(0),S=(0,r.Z)(N,2),T=S[0],P=S[1],I=(0,i.useState)(""),D=(0,r.Z)(I,2),M=D[0],E=D[1],B=(0,i.useState)(!1),O=(0,r.Z)(B,2),$=O[0],z=O[1],R=(0,i.useState)([]),q=(0,r.Z)(R,2),W=q[0],U=q[1],G=(0,i.useState)([]),X=(0,r.Z)(G,2),J=X[0],Q=X[1],Y=(0,i.useState)(1),ee=(0,r.Z)(Y,2),te=ee[0],ne=ee[1],re=(0,i.useState)(""),se=(0,r.Z)(re,2),ie=se[0],oe=se[1],de=(0,i.useState)("market"),ue=(0,r.Z)(de,2),me=ue[0],xe=ue[1],he=(0,i.useState)((0,F.d3)(w,M,o)),_e=(0,r.Z)(he,2),pe=_e[0],ve=_e[1],ge=(0,i.useState)({}),fe=(0,r.Z)(ge,2),je=fe[0],Ze=fe[1],ke=(0,i.useState)({}),be=(0,r.Z)(ke,2),Ne=be[0],Se=be[1],Te=(0,i.useState)(0),Pe=(0,r.Z)(Te,2),Ie=Pe[0],Ce=Pe[1],$e=(0,i.useState)(0),ze=(0,r.Z)($e,2),Re=ze[0],qe=ze[1],We=(0,i.useState)(0),Ae=(0,r.Z)(We,2),Ue=Ae[0],He=Ae[1],Ke=(0,i.useState)(!1),Ge=(0,r.Z)(Ke,2),Xe=Ge[0],Ve=Ge[1],Je=Be(w,[...s,c]),Qe=Be(M,[...s,c]);(0,i.useEffect)((()=>{s&&s.length>0&&t({type:"future/getPairs"})}),[s,t]),(0,i.useEffect)((()=>{var e=[];o&&s.length&&o.forEach((t=>{var n=e.findIndex((e=>e.id&&e.id.toLowerCase()===t.indexToken.toLowerCase()));if(n<0){var a=Be(t.indexToken,[...s,A.bn]);e.push(a)}})),U(e),!M&&e[1]&&(E(e[1].id),t({type:"tokens/save",payload:{chartSelectedTokenId:e[1].id}}))}),[o,s,t,M]),(0,i.useEffect)((()=>{var e=[];o&&s.length&&o.forEach((t=>{if(t.indexToken.toLowerCase()===M.toLowerCase()){var n=Be(t.collateralToken,[...s,c]);e.push(n)}})),Q(e),!e.find((e=>e.id===w))&&e[0]&&y(e[0].id)}),[M]);var Ye=(0,i.useMemo)((()=>(0,d.Ce)(f,pe.userCollateralPrice)),[f,pe]);(0,i.useEffect)((()=>{pe&&Ce(pe.userIndexPrice)}),[pe]),(0,i.useEffect)((()=>{var e=()=>{console.log(pe,f,T,"findPos");var e=_.find((e=>e.collateralToken.toLowerCase()===w.toLowerCase()&&e.indexToken.toLowerCase()===M.toLowerCase()&&e.isLong===m));return e||{}},n=(0,F.d3)(w,M,o);ve(n),t({type:"tokens/save",payload:{chartSelectedPair:n}}),Ze(e())}),[w,M,o&&o.length>0,_.length>0]);var et=(e,t)=>{try{var n=pe.indexPrice;"limit"===me&&(n=(0,F.Lk)(String(Ie),0)),console.log(je,pe,e,t,pe.collateralPrice,n,"opIncreasePositionParams");var r=(0,Ee.Xl)(je,pe,e,t,pe.collateralPrice,n);console.log(r,"opIncreasePosition"),Se((0,a.Z)((0,a.Z)({},r),{},{liqPrice:(0,F.T$)(r.indexLiqPrice),tradingFeeRate:new ae.Z(r.tradingFeeRate).div(Math.pow(10,7)).toFixed(2),amountInRaw:e,amountOutRaw:t}))}catch(s){Se({}),console.log(s),ce.default.error(s.message||"unknown error")}},tt=(e,t)=>{try{var n=pe.indexPrice;"limit"===me&&(n=(0,F.Lk)(String(Ie),0));var a=(0,Ee.iM)(je,pe,BigInt(te*Ee.sz),BigInt(t),BigInt(e),pe.collateralPrice,n);return console.log(a),et(a.marginDelta,a.sizeDelta),a}catch(r){return console.log(r),{marginDelta:-1}}},nt=e=>{if(e){var t=(0,d.xo)(e.toString(),pe.userCollateralTokenDecimal),n=tt(0,t),a=n.sizeDelta;a<0&&(a=0n);var r=(0,d.gB)(a.toString(),pe.userIndexTokenDecimal);console.log(r,"setAmountOut"),P(r)}else P(0)},at=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(t){var n;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return j(t),oe("in"),e.next=4,(0,d.bX)(x,h);case 4:if(n=e.sent,n){e.next=7;break}return e.abrupt("return");case 7:(0,d.Ds)(nt,500)(t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),rt=e=>{y(e.id)},st=e=>{if(e){var t=(0,d.xo)((e||0).toString(),pe.userIndexTokenDecimal),n=tt(t,0),a=n.marginDelta;a<0&&(a=0n);var r=(0,d.gB)(a.toString(),pe.userCollateralTokenDecimal);j(r)}else j(0)};(0,i.useEffect)((()=>{"in"===ie?nt(f):"out"===ie&&st(T)}),[te,w,M]);var it=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(t){var n;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return P(t),oe("out"),e.next=4,(0,d.bX)(x,h);case 4:if(n=e.sent,n){e.next=7;break}return e.abrupt("return");case 7:(0,d.Ds)(st,500)(t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lt=e=>{E(e.id),t({type:"tokens/save",payload:{chartSelectedTokenId:e.id}})},ct=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){var t,n,a,r,s,i,l,c,o;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,F.Lk)(String(Ie),0),n=(0,F.Lk)(String(Re),0),a=(0,F.Lk)(String(Ue),0),e.next=6,Le.Z.getLimitMinExecFee(h);case 6:return r=e.sent,s=(0,Ee.jo)(pe,m,Ne.notionalDelta,pe.collateralPrice,pe.indexPrice,a,n),i=s.minSizeDelta,l=s.maxSizeDelta,c={_collateralToken:w,_indexToken:M,_isLong:m,_increaseMarginDelta:Ne.amountInRaw,_increaseNotionalDelta:Ne.notionalDelta,_increaseSizeDelta:(0,Ee.Vd)(pe,m,Ne.notionalDelta,(0,F.Lk)("1",0),pe.indexPrice,t),_increaseExecFee:r,_decreaseNotionalDelta:Ne.notionalDelta,_decreaseMinSizeDelta:i,_decreaseMaxSizeDelta:l,_decreaseExecFee:r},e.next=11,Le.Z.limitIncreaseAndDecreasePosition(h,c,x);case 11:return o=e.sent,e.abrupt("return",o);case 15:e.prev=15,e.t0=e["catch"](0),console.log(e.t0),ce.default.error(e.t0.message||"unknown error");case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),ot=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){var t,n,a,r;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,F.Lk)(String(Ie),0),e.next=4,Le.Z.getLimitMinExecFee(h);case 4:return n=e.sent,a={_collateralToken:w,_indexToken:M,_isLong:m,_marginDelta:Ne.amountInRaw,_notionalDelta:Ne.notionalDelta,_sizeDelta:(0,Ee.Vd)(pe,m,Ne.notionalDelta,pe.collateralPrice,pe.indexPrice,t),_execFee:n},e.next=8,Le.Z.limitIncreasePosition(h,a,x);case 8:return r=e.sent,e.abrupt("return",r);case 12:e.prev=12,e.t0=e["catch"](0),console.log(e.t0),ce.default.error(e.t0.message||"unknown error");case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),dt=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){var n;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t({type:"future/increasePosition",payload:{params:{_collateralToken:w,_indexToken:M,_isLong:m,_amountIn:Ne.amountInRaw,_notionalDelta:Ne.notionalDelta}}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ut=e=>{v.Z.destroyAll(),v.Z.warning({title:"",width:420,className:we().modal,wrapClassName:we().modalWrap,icon:null,getContainer:()=>document.getElementById("J_Page")||document.body,okText:"Close",onOk:()=>{j(0),P(0),t({type:"future/getPairs"})},content:(0,u.jsxs)("div",{className:we().modalContainer,children:[(0,u.jsx)("div",{className:we().icon,children:(0,u.jsx)(ye.Z,{style:{color:"#20BBBB",fontSize:60}})}),(0,u.jsx)("p",{className:we().title,children:"Success"}),(0,u.jsxs)("p",{className:we().subTitle,children:[m?"Long":"Short"," ",T," ",Qe.symbol," with $",f," ",Je.symbol," collateral"]}),(0,u.jsx)("a",{href:"https://sepolia.etherscan.io/tx/".concat(e),target:"_blank",rel:"noreferrer",children:"View on explorer"})]})})},mt=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){var n,a;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,d.bX)(x,h);case 2:if(n=e.sent,n){e.next=5;break}return e.abrupt("return");case 5:if(z(!0),"market"!==me){e.next=12;break}return e.next=9,dt();case 9:a=e.sent,e.next=21;break;case 12:if(!Xe){e.next=18;break}return e.next=15,ct();case 15:a=e.sent,e.next=21;break;case 18:return e.next=20,ot();case 20:a=e.sent;case 21:a&&a.hash&&(console.log(a,"res"),"limit"===me?ut(a.hash):((0,Fe.x)({msg:m?(0,u.jsxs)("div",{className:"".concat(we().result_icon," ").concat(we().green),children:[(0,u.jsx)(Me.Z,{type:"icon-up"}),(0,Z.Z)("long_opend")]}):(0,u.jsxs)("div",{className:"".concat(we().result_icon," ").concat(we().red),children:[(0,u.jsx)(Me.Z,{type:"icon-down1"}),(0,Z.Z)("short_opend")]}),txid:a.hash,token:Qe,onOk:()=>{j(0),P(0),t({type:"future/getPairs"})}}),t({type:"future/getPositionList"}))),z(!1);case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xt=!!o&&o.length<1&&!!s,ht={slPrice:Ue,setSlPrice:He,tpPrice:Re,setTpPrice:qe,tpsl:Xe,setTPSL:e=>{if(Ve(e),e){var t=Number((1.1*Ie).toFixed(2)),n=Number((.9*Ie).toFixed(2));qe(m?t:n),He(m?n:t)}},targetPrice:Ie,amountOut:T,isLong:m,tradeType:me},_t=()=>{"limit"===me?(v.Z.destroyAll(),v.Z.warning({title:"",width:420,className:we().modal,wrapClassName:we().modalWrap,icon:null,getContainer:()=>document.getElementById("J_Page")||document.body,okText:"Sign transaction in wallet",onOk:()=>{v.Z.destroyAll(),mt()},maskClosable:!0,content:(0,u.jsxs)("div",{className:we().modalContainer,children:[(0,u.jsxs)("p",{className:we().title,children:["Confirm ",m?"Long":"Short"]}),(0,u.jsxs)("p",{className:we().subTitle,children:[m?"Long":"Short"," ",T," ",Qe.symbol," with $",f," ",Je.symbol," collateral"]}),(0,u.jsxs)("div",{className:we().content,children:[(0,u.jsx)(Oe,{label:"Max slippage",value:"0.2%"}),(0,u.jsx)(Oe,{label:"Leverage",value:"".concat(te,"x")}),(0,u.jsx)(Oe,{label:"Entry Price",value:"$".concat(Ie)})]})]})})):mt()};return(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("div",{className:we().container,children:(0,u.jsxs)(C.g,{spinning:xt||$,children:[(0,u.jsxs)("div",{className:we().tradeTypes,children:[(0,u.jsx)("span",{className:"market"===me&&we().active,onClick:()=>{xe("market")},children:"Market"}),(0,u.jsx)("span",{className:"limit"===me&&we().active,onClick:()=>{xe("limit")},children:"Limit"})]}),(0,u.jsxs)("div",{className:we().card,children:[(0,u.jsxs)("div",{className:we().label,children:[(0,u.jsxs)("div",{children:[(0,Z.Z)("pay"),"(",(0,Z.Z)("margin"),"+",(0,Z.Z)("fee"),"): $",Ye]}),(0,u.jsxs)("div",{children:[(0,Z.Z)("balance"),":\xa0",(0,u.jsx)("span",{className:"primary",onClick:()=>at(parseFloat(Je.userTokenBalance)),children:Je.userTokenBalance})]})]}),(0,u.jsxs)("div",{className:we().value,children:[(0,u.jsx)(le.Z,{className:"inputTxt",value:f,onChange:at,min:0}),(0,u.jsx)(L,{currentToken:Je,changeToken:rt,data:J,isLogin:n,loading:xt})]})]}),(0,u.jsxs)("div",{className:we().card,children:[(0,u.jsxs)("div",{className:we().label,children:[(0,u.jsxs)("div",{className:m?we().green:we().red,children:[m?(0,Z.Z)("long"):(0,Z.Z)("short"),": $",(0,d.Ce)(T,"market"===me?pe.userIndexPrice:Ie)]}),"market"===me&&(0,u.jsxs)("div",{children:[(0,Z.Z)("market_price"),": $",pe.userIndexPrice]})]}),(0,u.jsxs)("div",{className:we().value,children:[(0,u.jsx)(le.Z,{className:"inputTxt",value:T,onChange:it,min:0}),(0,u.jsx)(L,{currentToken:Qe,changeToken:lt,data:W,isLogin:n,loading:xt})]})]}),"limit"===me&&(0,u.jsxs)("div",{className:we().card,children:[(0,u.jsxs)("div",{className:we().label,children:[(0,u.jsx)("div",{children:(0,Z.Z)("price")}),(0,u.jsxs)("div",{children:[(0,Z.Z)("market_price"),": $",pe.userIndexPrice]})]}),(0,u.jsxs)("div",{className:we().value,children:[(0,u.jsx)(le.Z,{className:"inputTxt",value:Ie,onChange:Ce,min:0}),(0,u.jsx)("p",{style:{marginBottom:0},children:"USD"})]})]}),(0,u.jsx)(De,(0,a.Z)({maxLeverage:pe.userMaxLeverage,leverage:te,setLeverage:ne},ht)),(0,u.jsxs)("div",{className:we().info,children:[(0,u.jsxs)("div",{className:we().item,children:[(0,u.jsx)("div",{className:we().label,children:(0,Z.Z)("entry_price")}),(0,u.jsxs)("div",{className:we().fee,children:["$","market"===me?pe.userIndexPrice:Ie]})]}),"market"===me&&(0,u.jsxs)("div",{className:we().item,children:[(0,u.jsx)("div",{className:we().label,children:(0,Z.Z)("liquidation_price")}),(0,u.jsx)("div",{className:we().fee,children:Ne.liqPrice&&"$".concat(Ne.liqPrice)})]}),"market"===me&&(0,u.jsxs)("div",{className:we().item,children:[(0,u.jsx)("div",{className:we().label,children:(0,Z.Z)("funding_rate")}),(0,u.jsxs)("div",{className:we().fee,children:[pe.userTradingFeeRate,"%/1h"]})]}),(0,u.jsxs)("div",{className:we().item,children:[(0,u.jsx)("div",{className:we().label,children:"Fees"}),(0,u.jsxs)("div",{className:we().fee,children:[Ne.tradingFeeRate,"%"]})]})]}),(0,u.jsx)(V.Z,{height:50,align:"center",onClick:_t,className:m?we().green_btn:we().red_btn,conditions:[{handle:!w||!M,txt:(0,Z.Z)("select_asset")},{handle:f<=0||T<=0,txt:(0,Z.Z)("input_amount")},{handle:f>parseFloat(Je.userTokenBalance||"0"),txt:(0,Z.Z)("lack_balance")},{handle:"limit"===me&&(m&&Ie>=pe.userIndexPrice||!m&&Ie<=pe.userIndexPrice),txt:(0,Z.Z)("invalid_limit_price")}],children:m?(0,Z.Z)("open_long"):(0,Z.Z)("open_short")})]})})})}var ze=e=>{var t=e.tokens,n=e.wallet,r=e.future;return(0,a.Z)((0,a.Z)((0,a.Z)({},t),n),r)},Re=(0,l.$j)(ze)($e),qe=n(42226),We=n.n(qe);function Ae(e){var t=e.network,n=(0,i.useState)(0),a=(0,r.Z)(n,2),s=a[0],l=a[1],c=[(0,u.jsx)(ie,{},"swap"),(0,u.jsx)(Re,{isLong:!0},"long"),(0,u.jsx)(Re,{isLong:!1},"short")];return(0,i.useEffect)((()=>{"zk"!==t&&"sepolia"!==t&&l(0)}),[t]),"zk"===t||"sepolia"===t?(c.length=3,A.Dx[1].disabled=!1,A.Dx[2].disabled=!1):(c.length=1,A.Dx[1].disabled=!0,A.Dx[2].disabled=!0),(0,u.jsxs)("div",{className:We().container,children:[(0,u.jsx)(U.Z,{menuIndex:s,setMenuIndex:l,menuDatas:A.Dx,className:We().menu}),c.map(((e,t)=>(0,u.jsx)("div",{style:{display:t===s?"block":"none"},children:e},t)))]})}n(52922);var Ue=n(41314),He=n(1055),Ke=n.n(He),Ge=n(60155),Xe=n.n(Ge),Ve=n(66996),Je=n(9696),Qe=n.n(Je);function Ye(e){var t=e.currentToken,n=e.amountIn,a=e.isAdd,s=t.margin,l=t.pair,c=t.openNotional,o=t.userLiqPrice,m=(0,i.useState)({}),x=(0,r.Z)(m,2),h=x[0],_=x[1];return(0,i.useEffect)((()=>{var e=(0,d.xo)(n||"0",l.userCollateralTokenDecimal),r=[t,l,BigInt(e),l.collateralPrice,l.indexPrice],i=a?(0,Ee.G1)(...r):(0,Ee.pK)(...r),u=(0,F.Qy)(s,c),m=(0,F.Qy)(i.pos.margin,i.pos.openNotional),x=(0,F.z)((0,Ee.li)(t,l,l.collateralPrice,l.indexPrice)),h=(0,F.z)(i.mr),p=(0,F.z)(i.pos.mmr),v=(0,d.gB)(s.toString(),l.userCollateralTokenDecimal),g=(0,d.gB)(i.pos.margin.toString(),l.userCollateralTokenDecimal),f=(0,F.T$)((0,Ee.ey)(i.pos,i.pair,i.pair.collateralPrice,i.pair.indexPrice),4);n||(m=u,h=x,g=v,f=o),_({oldLeverage:u,newLeverage:m,oldMr:x,newMr:h,mmr:p,oldMargin:v,newMargin:g,newLiqPrice:f})}),[t,n]),(0,u.jsxs)("div",{className:Qe().info,children:[(0,u.jsxs)("div",{className:Qe().item,children:[(0,u.jsx)("div",{className:Qe().label,children:(0,Z.Z)("leverage")}),(0,u.jsxs)("div",{className:Qe().value,children:[h.oldLeverage," ",(0,u.jsx)(g.ol,{})," ",h.newLeverage]})]}),(0,u.jsxs)("div",{className:Qe().item,children:[(0,u.jsx)("div",{className:Qe().label,children:(0,Z.Z)("margin_rate")}),(0,u.jsxs)("div",{className:Qe().value,children:[h.oldMr," ",(0,u.jsx)(g.ol,{})," ",h.newMr]})]}),(0,u.jsxs)("div",{className:Qe().item,children:[(0,u.jsx)("div",{className:Qe().label,children:(0,Z.Z)("maintenance_margin_rate")}),(0,u.jsx)("div",{className:Qe().value,children:h.mmr})]}),(0,u.jsxs)("div",{className:Qe().item,children:[(0,u.jsxs)("div",{className:Qe().label,children:["EST ",(0,Z.Z)("liq_price")]}),(0,u.jsxs)("div",{className:Qe().value,children:["$",o," ",(0,u.jsx)(g.ol,{})," $",h.newLiqPrice]})]})]})}var et=e=>{var t=e.future;return(0,a.Z)({},t)},tt=(0,l.$j)(et)(Ye);function nt(e){var t=(0,l.I0)(),n=e.currentToken,a=e.loading,s=e.closeModal,c=n.userMargin,o=n.collateralTokenObj,m=n.indexTokenObj,x=n.isLong,h=n.pair,_=o.userTokenBalance,p=(0,i.useState)(!1),v=(0,r.Z)(p,2),g=v[0],f=v[1],j=(0,i.useState)(0),b=(0,r.Z)(j,2),w=b[0],y=b[1],N=e=>{y(e)},S=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){var a;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return f(!0),e.prev=1,e.next=4,t({type:"future/increaseMargin",payload:{tokenId:o.id,params:{_collateralToken:o.id,_indexToken:m.id,_isLong:x,_amountIn:(0,d.xo)(w.toString(),o.tokenDecimal)}}});case 4:a=e.sent,a.hash?((0,Fe.x)({msg:(0,Z.Z)("success"),txid:a.hash,token:n,onOk:()=>{s(),t({type:"future/getPairs"})}}),t({type:"future/getPositionList"})):(0,ee.y)("Failed"),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),(0,ee.y)(e.t0);case 11:f(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return(0,u.jsx)(C.g,{spinning:a||g,children:(0,u.jsxs)("div",{className:Xe().container,children:[(0,u.jsxs)("div",{className:Xe().card,children:[(0,u.jsxs)("div",{className:Xe().label,children:[(0,u.jsxs)("div",{children:[(0,Z.Z)("current_margin"),": $",(0,d.Ce)(c,h.userCollateralPrice)]}),(0,u.jsxs)("div",{children:[(0,Z.Z)("wallet_bal"),":\xa0",(0,u.jsx)("span",{className:"primary",onClick:()=>N(parseFloat(_)),children:_})]})]}),(0,u.jsxs)("div",{className:Xe().value,children:[(0,u.jsx)(le.Z,{className:"inputTxt",value:w,onChange:N,min:0}),(0,u.jsx)(k.Z,{data:o})]}),(0,u.jsx)(Ve.Z,{amount:w,onChange:N,max:_})]}),(0,u.jsx)(tt,{currentToken:n,amountIn:w,isAdd:!0}),(0,u.jsx)(V.Z,{height:50,align:"center",onClick:S,conditions:[{handle:w<=0,txt:(0,Z.Z)("input_amount")},{handle:w>parseFloat(_||"0"),txt:(0,Z.Z)("lack_balance")}],children:(0,Z.Z)("incrase_margin")})]})})}var at=e=>{var t=e.future;return(0,a.Z)({},t)},rt=(0,l.$j)(at)(nt);function st(e){var t=(0,l.I0)(),n=e.currentToken,a=e.loading,s=e.closeModal,c=n.userMargin,o=n.collateralTokenObj,m=n.indexTokenObj,x=n.isLong,h=n.pair,_=(0,i.useState)(!1),p=(0,r.Z)(_,2),v=p[0],g=p[1],f=(0,i.useState)(0),j=(0,r.Z)(f,2),b=j[0],w=j[1],y=(0,i.useState)("0"),N=(0,r.Z)(y,2),S=N[0],T=N[1],P=e=>{w(e)};(0,i.useEffect)((()=>{var e=(0,Ee.sl)(n,h,h.collateralPrice,h.indexPrice),t=(0,d.gB)(e.toString(),h.userCollateralTokenDecimal);T(t)}),[]);var I=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){var a;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return g(!0),e.prev=1,e.next=4,t({type:"future/decreaseMargin",payload:{tokenId:o.id,params:{_collateralToken:o.id,_indexToken:m.id,_isLong:x,_amountOut:(0,d.xo)(b.toString(),o.tokenDecimal)}}});case 4:a=e.sent,a.hash?((0,Fe.x)({msg:(0,Z.Z)("success"),txid:a.hash,token:n,onOk:()=>{s(),t({type:"future/getPairs"})}}),t({type:"future/getPositionList"})):(0,ee.y)("Failed"),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),(0,ee.y)(e.t0);case 11:g(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return(0,u.jsx)(C.g,{spinning:a||v,children:(0,u.jsxs)("div",{className:Xe().container,children:[(0,u.jsxs)("div",{className:Xe().card,children:[(0,u.jsxs)("div",{className:Xe().label,children:[(0,u.jsxs)("div",{children:[(0,Z.Z)("max_removable"),":"," ",(0,u.jsx)("span",{className:"primary",onClick:()=>P(parseFloat(S)),children:S})]}),(0,u.jsxs)("div",{children:[(0,Z.Z)("current_margin"),": ",c]})]}),(0,u.jsxs)("div",{className:Xe().value,children:[(0,u.jsx)(le.Z,{className:"inputTxt",value:b,onChange:P,min:0}),(0,u.jsx)(k.Z,{data:o})]}),(0,u.jsx)(Ve.Z,{amount:b,onChange:P,max:S})]}),(0,u.jsx)(tt,{currentToken:n,amountIn:b,isAdd:!1}),(0,u.jsx)(V.Z,{height:50,align:"center",onClick:I,conditions:[{handle:b<=0,txt:(0,Z.Z)("input_amount")},{handle:b>=parseFloat(c||"0"),txt:(0,Z.Z)("lack_balance")}],children:(0,Z.Z)("withdraw_margin")})]})})}var it=e=>{var t=e.future;return(0,a.Z)({},t)},lt=(0,l.$j)(it)(st);function ct(e){var t=e.visible,n=e.setVisible,a=e.currentToken,s=(0,i.useState)(0),l=(0,r.Z)(s,2),c=l[0],o=l[1];return(0,u.jsxs)(v.Z,{width:420,footer:null,open:t,getContainer:()=>document.getElementById("J_Page")||document.body,onCancel:()=>n(!1),closable:!1,children:[(0,u.jsx)(U.Z,{menuDatas:A.o7,menuIndex:c,setMenuIndex:o}),(0,u.jsx)("div",{style:{display:0===c?"block":"none"},children:(0,u.jsx)(rt,{currentToken:a,closeModal:()=>n(!1)})}),(0,u.jsx)("div",{style:{display:1===c?"block":"none"},children:(0,u.jsx)(lt,{currentToken:a,closeModal:()=>n(!1)})})]})}var ot=n(56804),dt=n(21597),ut=n.n(dt),mt=n(58162),xt=n.n(mt);function ht(e){var t=e.currentToken,n=e.amountIn,a=t.collateralTokenObj,s=t.userSize,l=t.margin,c=t.userMargin,o=t.openNotional,m=t.pair,x=(0,i.useState)({}),h=(0,r.Z)(x,2),_=h[0],p=h[1];return(0,i.useEffect)((()=>{var e=(0,d.xo)(n||"0",m.userIndexTokenDecimal),a=(0,Ee.Rh)(t,m,BigInt(e),m.collateralPrice,m.indexPrice),r=(0,F.BE)(a.pnl,m.userCollateralTokenDecimal,l),i=r.isPositive,u=r.pnlStr,x=r.roeStr,h=(0,F.Qy)(l,o),_=(0,d.gB)(a.receiveMargin.toString(),m.userCollateralTokenDecimal),v=(0,F.z)(a.mr),g=(0,F.T$)(a.indexLiqPrice),f=new ae.Z(s-n).div(s).multipliedBy(c).toFixed(6);n>=s&&(v="--",g="--"),p({isPositive:i,pnlStr:u,roeStr:x,leverage:h,receive:_,mr:v,liqPrice:g,leftMargin:f})}),[t,n]),(0,u.jsxs)("div",{className:Qe().info,children:[(0,u.jsxs)("div",{className:Qe().item,children:[(0,u.jsxs)("div",{className:Qe().label,children:[(0,Z.Z)("pnl"),"/",(0,Z.Z)("roe")]}),(0,u.jsxs)("div",{className:_.isPositive?"primary":"red",children:[_.pnlStr,"/",_.roeStr]})]}),(0,u.jsxs)("div",{className:Qe().item,children:[(0,u.jsx)("div",{className:Qe().label,children:(0,Z.Z)("leverage")}),(0,u.jsx)("div",{className:Qe().value,children:_.leverage})]}),(0,u.jsxs)("div",{className:Qe().item,children:[(0,u.jsx)("div",{className:Qe().label,children:(0,Z.Z)("margin")}),(0,u.jsxs)("div",{className:Qe().value,children:[c," ",(0,u.jsx)(g.ol,{})," ",_.leftMargin]})]}),(0,u.jsxs)("div",{className:Qe().item,children:[(0,u.jsx)("div",{className:Qe().label,children:(0,Z.Z)("margin_rate")}),(0,u.jsx)("div",{className:Qe().value,children:_.mr})]}),(0,u.jsxs)("div",{className:Qe().item,children:[(0,u.jsxs)("div",{className:Qe().label,children:["EST ",(0,Z.Z)("liquidation_price")]}),(0,u.jsxs)("div",{className:Qe().value,children:["$",_.liqPrice]})]}),(0,u.jsxs)("div",{className:Qe().item,children:[(0,u.jsx)("div",{className:Qe().label,children:(0,Z.Z)("receive")}),(0,u.jsxs)("div",{className:_.isPositive?"primary":"red",children:[_.receive," ",(0,Z.Z)("in")," ",a.symbol]})]})]})}var _t=e=>{var t=e.future;return(0,a.Z)({},t)},pt=(0,l.$j)(_t)(ht);function vt(e){var t=(0,l.I0)(),n=e.currentToken,a=e.loading,s=e.closeModal,c=n.userSize,o=n.collateralTokenObj,m=n.indexTokenObj,x=n.isLong,h=n.userMargin,_=n.pair,p=(0,i.useState)(!1),v=(0,r.Z)(p,2),g=v[0],f=v[1],j=(0,i.useState)(0),b=(0,r.Z)(j,2),w=b[0],y=b[1],N=e=>{y(e)},S=e=>{var t=(0,Ee.Rh)(n,_,BigInt(e),_.collateralPrice,_.indexPrice);return console.log("data:",t),t},T=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){var n,a,r;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return f(!0),console.log(w,c),n=(0,d.xo)(w.toString(),_.userIndexTokenDecimal),a=S(n),e.prev=4,e.next=7,t({type:"future/decreasePosition",payload:{tokenId:o.id,params:{_collateralToken:o.id,_indexToken:m.id,_isLong:x,_marginDelta:w===c?0:new ae.Z(w).div(c).multipliedBy(h).multipliedBy(Math.pow(10,_.userCollateralTokenDecimal)).toFixed(0),_notionalDelta:a.notionalDelta}}});case 7:r=e.sent,r.hash&&((0,Fe.x)({msg:x?(0,u.jsxs)("div",{className:"".concat(xt().result_icon," ").concat(xt().green),children:[(0,u.jsx)(Me.Z,{type:"icon-up"}),(0,Z.Z)("long_closed")]}):(0,u.jsxs)("div",{className:"".concat(xt().result_icon," ").concat(xt().red),children:[(0,u.jsx)(Me.Z,{type:"icon-down1"}),(0,Z.Z)("short_closed")]}),txid:r.hash,token:m,onOk:()=>{s(),t({type:"future/getPairs"})}}),t({type:"future/getPositionList"})),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](4),(0,ee.y)(e.t0);case 14:f(!1);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(){return e.apply(this,arguments)}}();return(0,u.jsx)(C.g,{spinning:a||g,children:(0,u.jsxs)("div",{className:xt().container,children:[(0,u.jsxs)("div",{className:xt().card,children:[(0,u.jsxs)("div",{className:xt().label,children:[(0,u.jsxs)("div",{children:[(0,Z.Z)("close")," ",x?(0,Z.Z)("long"):(0,Z.Z)("short"),": $",(0,d.Ce)(w,_.userIndexPrice)]}),(0,u.jsxs)("div",{children:[(0,Z.Z)("position_size"),":\xa0",(0,u.jsx)("span",{className:"primary",onClick:()=>N(c),children:c})]})]}),(0,u.jsxs)("div",{className:xt().value,children:[(0,u.jsx)(le.Z,{className:"inputTxt",value:w,onChange:N,min:0,max:c}),(0,u.jsx)(k.Z,{data:m})]}),(0,u.jsx)(Ve.Z,{amount:w,onChange:N,max:c})]}),(0,u.jsxs)("div",{className:xt().card,children:[(0,u.jsxs)("div",{className:xt().label,children:[(0,u.jsx)("div",{children:(0,Z.Z)("price")}),(0,u.jsxs)("div",{children:[(0,Z.Z)("mark"),":",_.userIndexPrice]})]}),(0,u.jsxs)("div",{className:xt().value,children:[(0,u.jsx)("div",{children:_.userIndexPrice}),(0,u.jsx)("div",{children:"USD"})]})]}),(0,u.jsx)(pt,{currentToken:n,amountIn:w}),(0,u.jsx)(V.Z,{height:50,align:"center",onClick:T,conditions:[{handle:w<=0,txt:(0,Z.Z)("input_amount")},{handle:w>parseFloat(c||"0"),txt:(0,Z.Z)("lack_balance")}],children:(0,Z.Z)("close_position")})]})})}var gt=e=>{var t=e.future;return(0,a.Z)({},t)},ft=(0,l.$j)(gt)(vt);function jt(e){var t=e.visible,n=e.setVisible,a=e.currentToken,s=(0,i.useState)(1),l=(0,r.Z)(s,2),c=l[0],o=l[1];return(0,u.jsxs)(v.Z,{width:420,footer:null,open:t,getContainer:()=>document.getElementById("J_Page")||document.body,onCancel:()=>n(!1),closable:!1,wrapClassName:ut().modal,children:[(0,u.jsx)(U.Z,{menuDatas:A.UT,menuIndex:c,setMenuIndex:o}),(0,u.jsx)("div",{style:{display:1===c?"block":"none"},children:(0,u.jsx)(ft,{currentToken:a,closeModal:()=>n(!1)})})]})}function Zt(e){var t=e.positionList,n=e.account,a=e.tokenPairs,s=e.tokenDatas,c=(0,l.I0)(),o=(0,i.useState)(!1),m=(0,r.Z)(o,2),x=m[0],h=m[1],_=(0,i.useState)(!1),p=(0,r.Z)(_,2),v=p[0],g=p[1],f=(0,i.useState)({}),j=(0,r.Z)(f,2),k=j[0],b=j[1],w=(0,i.useState)(!1),y=(0,r.Z)(w,2),N=y[0],S=y[1],T=(0,i.useState)(0),P=(0,r.Z)(T,2),I=(P[0],P[1],(0,i.useRef)(null));(0,i.useEffect)((()=>{var e=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return S(!0),e.next=4,c({type:"future/getPositionList"});case 4:S(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();a&&a.length>0&&e()}),[n,a]),(0,i.useEffect)((()=>(I.current=setInterval((0,K.Z)((0,H.Z)().mark((function e(){return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n&&a&&a.length;case 1:case"end":return e.stop()}}),e)}))),5e3),()=>{clearInterval(I.current)})),[n,a,c]);var C=e=>{b(e),h(!0)},D=e=>{b(e),g(!0)},L=[{title:(0,u.jsxs)("div",{children:[(0,Z.Z)("positions"),(0,u.jsx)("br",{}),(0,Z.Z)("funding_rate")]}),dataIndex:"positions",key:"positions",align:"left",render:(e,t)=>{var n=t.indexTokenObj,a=t.isLong,r=t.pair,s=t.openNotional,i=t.margin,l=(a?r.longFundingRate:r.shortFundingRate).toString(),c=(0,d.gB)(l,7),o=(0,F.Qy)(i,s);return(0,u.jsxs)("div",{className:Ke().type,children:[(0,u.jsx)("span",{className:a?Ke().green:Ke().red,children:a?"L":"S"})," ",n.symbol," ",(0,u.jsx)("span",{className:Ke().text,children:o}),(0,u.jsx)("br",{}),(0,u.jsxs)("span",{className:Ke().text,children:[c,"%/1h"]})]})}},{title:(0,u.jsxs)("div",{children:[(0,Z.Z)("size"),(0,u.jsx)("br",{})," ",(0,Z.Z)("pnl"),"/",(0,Z.Z)("roe")]}),dataIndex:"userSize",key:"userSize",align:"right",render:(e,t)=>{var n=t.indexTokenObj,a=t.pair,r=t.margin,s=(0,Ee.YT)(t,a,a.collateralPrice,a.indexPrice),i=(0,F.BE)(s,a.userCollateralTokenDecimal,r),l=i.isPositive,c=i.pnlStr,o=i.roeStr;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{children:[(0,d.FH)(e,4)," ",n.symbol]}),(0,u.jsxs)("div",{className:l?Ke().green:Ke().red,children:[c," (",o,")"]})]})}},{title:(0,u.jsxs)(u.Fragment,{children:[(0,Z.Z)("margin"),(0,u.jsx)("br",{}),(0,Z.Z)("value")]}),dataIndex:"userMargin",key:"userMargin",align:"right",render:(e,t)=>{var n=t.collateralTokenObj,a=t.pair;return(0,u.jsxs)("div",{children:[e," ",n.symbol," ",(0,u.jsx)("br",{}),"$",(0,d.Ce)(e,a.userCollateralPrice)]})}},{title:(0,u.jsxs)(u.Fragment,{children:[(0,Z.Z)("entry_price"),(0,u.jsx)("br",{}),(0,Z.Z)("liq_price")]}),dataIndex:"userEntryIndexPrice",key:"userEntryIndexPrice",align:"right",render:(e,t)=>{var n=t.userLiqPrice;return(0,u.jsxs)("div",{children:["$",e,(0,u.jsx)("br",{}),"$",n]})}},{title:(0,u.jsxs)(u.Fragment,{children:[(0,Z.Z)("mr"),(0,u.jsx)("br",{}),(0,Z.Z)("mmr")]}),dataIndex:"mr",key:"mr",align:"right",render:(e,t)=>{var n=t.userMmr,a=t.pair,r=(0,Ee.li)(t,a,a.collateralPrice,a.indexPrice),s=(0,F.z)(r);return(0,u.jsxs)("div",{children:[s,(0,u.jsx)("br",{}),n,"%"]})}},{title:(0,Z.Z)("manage"),dataIndex:"manage",key:"manage",align:"center",render:(e,t)=>(0,u.jsxs)("div",{className:Ke().action,children:[(0,u.jsx)("span",{onClick:()=>C(t),children:(0,Z.Z)("edit_margin")}),(0,u.jsx)("span",{onClick:()=>D(t),className:Ke().close,children:(0,Z.Z)("close")})]})}];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Ue.Z,{columns:L,dataSource:t.filter((e=>e.size>0&&e.userSize)),className:Ke().table,rowKey:"id",loading:{spinning:N&&t.length<1&&!!s,indicator:(0,u.jsx)(ot.Z,{spin:!0,style:{fontSize:30}})}}),x&&(0,u.jsx)(ct,{visible:x,setVisible:h,currentToken:k}),v&&(0,u.jsx)(jt,{visible:v,setVisible:g,currentToken:k})]})}var kt=e=>{var t=e.tokens,n=e.future,r=e.wallet,s=e.loading,i=s.effects;return(0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},t),n),r),{},{loading:i["future/getPositionList"]||!1})},bt=(0,l.$j)(kt)(Zt),wt=n(50710),yt=n.n(wt),Nt=n(89072),St=10;function Tt(e){var t=e.account,n=e.type,a=e.positionList,s=e.walletChainId,c=e.dataSourceChainId,o=e.currentWallet,m=void 0===o?{}:o;console.log(e,"TradeHistory");var x=(0,l.I0)(),h=(0,i.useState)(0),_=(0,r.Z)(h,2),p=_[0],v=_[1],g=(0,i.useState)(1),f=(0,r.Z)(g,2),j=f[0],k=f[1],b=(0,i.useState)([]),w=(0,r.Z)(b,2),y=w[0],N=w[1],S=(0,i.useState)(!1),T=(0,r.Z)(S,2),P=T[0],I=T[1],C=(0,i.useState)(0),D=(0,r.Z)(C,2),L=D[0],F=D[1],M=(0,Nt.x)(s),E=(0,d.Hy)(c,m.network),B=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){var a,r;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("personal"!==n||t){e.next=2;break}return e.abrupt("return",v(0));case 2:return a="personal"===n?{account:t,network:E}:{network:E},e.next=5,x({type:"history/getOrderAggregationCount",payload:a});case 5:r=e.sent,v(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){var a,r,s,i=arguments;return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=i.length>0&&void 0!==i[0]?i[0]:1,"personal"!==n||t){e.next=3;break}return e.abrupt("return",N([]));case 3:return r={skip:(a-1)*St,first:St,network:E},"personal"===n&&(r.account=t),e.next=7,x({type:"history/getOrderAggregation",payload:r});case 7:s=e.sent,N(s);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((()=>{var e=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(){return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return I(!0),e.next=3,B();case 3:return e.next=5,O();case 5:I(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t,a.length]),(0,i.useEffect)((()=>{var e=setTimeout((0,K.Z)((0,H.Z)().mark((function e(){return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return F(L+1),e.next=3,B();case 3:O(j);case 4:case"end":return e.stop()}}),e)}))),3e4);return()=>{clearTimeout(e)}}),[L]);var $=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(t){return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log(t),k(t),O(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=[{title:"",dataIndex:"timestamp",key:"timestamp",width:180,render:e=>(0,d.p6)(1e3*e,"YYYY/MM/DD, HH:mm A")},{title:"",dataIndex:"content",key:"content"},{title:"",dataIndex:"account",key:"account",width:162,render:e=>(0,u.jsxs)(u.Fragment,{children:[(0,Z.Z)("owner"),":\xa0",(0,u.jsx)("a",{className:"primary",href:"".concat(M.exporerAccountUrl,"/").concat(e,"?network=").concat(M.network),target:"_blank",rel:"noreferrer",children:(0,d.Zp)(e)})]})}];return(0,u.jsx)("div",{className:yt().container,children:(0,u.jsx)("div",{className:yt().table_wrap,children:(0,u.jsx)(Ue.Z,{columns:z,dataSource:y,className:yt().table,rowKey:"timestamp",loading:{spinning:P&&y.length<1,indicator:(0,u.jsx)(ot.Z,{spin:!0,style:{fontSize:30}})},pagination:{onChange:$,total:p,showTotal:e=>{var t=St*j>e?e:St*j;return"".concat(St*(j-1)+1," - ").concat(t," of ").concat(e)}}})})})}var Pt=e=>{var t=e.future,n=e.history,r=e.wallet;return(0,a.Z)((0,a.Z)((0,a.Z)({},t),n),r)},It=(0,l.$j)(Pt)(Tt),Ct=(n(20228),n(11382)),Dt=n(22278),Lt=n.n(Dt),Ft=e=>{var t=e.list,n=void 0===t?[]:t,a=e.account,r=void 0===a?"":a,s=e.network,c=void 0===s?"":s,o=e.loading,m=e.chainId,x=e.tokenPairs,h=void 0===x?[]:x,_=e.tokens,p=(0,i.useMemo)((()=>h.length>0),[h]),v=(0,i.useMemo)((()=>_.tokenDatas.length>0),[_]),g=(0,l.I0)();(0,i.useEffect)((()=>{r&&p&&v&&(console.log("wtffff"),g({type:"future/fetchLimitOrder",payload:{account:r,network:c},callback:e=>{e.error&&console.log(e)}}))}),[r,c,p,v,g]);var f=function(){var e=(0,K.Z)((0,H.Z)().mark((function e(t){return(0,H.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return g({type:"future/save",payload:{limitOrder:n.map((e=>(e.submiting=e.id===t.id,e)))}}),e.prev=1,e.next=4,Le.Z.cancelIncreaseOrder(m,BigInt(t.orderIndex));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](1),console.log(e.t0);case 9:g({type:"future/fetchLimitOrder",payload:{account:r,network:c},callback:e=>{e.error&&console.log(e)}});case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),j=[{title:"Time",dataIndex:"timestamp",key:"timestamp",render:e=>(0,d.p6)(1e3*e,"MM/DD, HH:mm:ss"),align:"right"},{title:"Positions",dataIndex:"execStatusName",key:"execStatusName",align:"right",render:(e,t)=>(0,u.jsx)(u.Fragment,{children:3===t.execStatus&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:t.isLong?Lt().longText:Lt().shortText,children:t.isLong?"L":"S"})," ",(0,u.jsx)("span",{children:t.indexSymbol})]})})},{title:"Size",dataIndex:"notionalDeltaForUSD",key:"notionalDeltaForUSD",render:e=>"$".concat(e),align:"right"},{title:(0,u.jsxs)("div",{className:Lt().tableTh,children:[(0,u.jsx)("span",{children:"Margin"}),(0,u.jsx)("span",{children:"Value"})]}),dataIndex:"Margin",key:"Margin",render:(e,t)=>(0,u.jsxs)("div",{className:Lt().tableTh,children:[(0,u.jsxs)("span",{children:[e," ",t.collateralSymbol]}),(0,u.jsxs)("span",{children:["$",t.MarginValue]})]}),align:"right"},{title:"Price",dataIndex:"targetPrice",key:"targetPrice",align:"right",render:(e,t)=>(0,u.jsx)(u.Fragment,{children:t.targetPrice?"$".concat(t.targetPrice):"$".concat(t.maxPrice,"-$").concat(t.minPrice)})},{title:()=>(0,u.jsx)("span",{children:"Manage"}),key:"action",align:"right",render:(e,t)=>(console.log(t.submiting),(0,u.jsx)(Ct.Z,{spinning:Boolean(t.submiting),size:"small",children:(0,u.jsx)("span",{className:Lt().editText,onClick:()=>{f(t)},children:"Cancel"})}))}];return(0,u.jsx)("div",{className:Lt().container,children:(0,u.jsx)("div",{children:(0,u.jsx)(Ue.Z,{columns:j,dataSource:n,size:"small",loading:o,rowKey:"id"})})})},Mt=(0,l.$j)((e=>{var t=e.future,n=e.wallet,a=e.tokens,r=e.loading;return{list:t.limitOrder,tokenPairs:t.tokenPairs,account:n.account,network:n.currentWallet&&n.currentWallet.network,chainId:n.walletChainId,tokens:a,loading:r.effects["future/fetchLimitOrder"]}}))(Ft),Et=[(0,Z.Z)("positions"),(0,Z.Z)("trade_history"),(0,Z.Z)("market_trades"),(0,Z.Z)("open_orders")];function Bt(e){var t=e.isShowChart,n=e.dataSourceChainId,a=e.currentWallet,l=void 0===a?{}:a,c=(0,i.useState)(0),o=(0,r.Z)(c,2),m=o[0],x=o[1],h=(0,d.Hy)(n,l.network),_="zk"===h||"sepolia"===h;return(0,u.jsx)(s.Z,{children:(0,u.jsxs)("div",{className:W().container,children:[(0,u.jsx)(Ae,{network:h}),(0,u.jsxs)("div",{className:W().datas,children:[t&&(0,u.jsx)(R,{}),_&&(0,u.jsxs)("div",{className:W().table_datas,children:[(0,u.jsx)("div",{className:W().title_wrap,children:Et.map(((e,t)=>(0,u.jsx)("div",{className:t===m?W().current_title:W().title,onClick:()=>{x(t)},children:e},e)))}),0===m&&(0,u.jsx)(bt,{}),1===m&&(0,u.jsx)(It,{type:"personal"}),2===m&&(0,u.jsx)(It,{type:"market"}),3===m&&(0,u.jsx)(Mt,{})]})]})]})})}var Ot=e=>{var t=e.common,n=e.wallet;return(0,a.Z)((0,a.Z)({},t),n)},$t=(0,l.$j)(Ot)(Bt)}}]);